//Analysis Type - Regression 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double input_hidden_weights[40][5]=
{
 {-4.51001971662293e+000, 1.09644784887816e+000, 2.32590214359769e+000, 1.07434587008440e+000, 2.70002759768453e+000 },
 {5.20626163161915e-001, 4.57685731598087e-002, -3.68681251066465e-002, 4.41923500758527e-002, -3.96934962693017e-001 },
 {-2.26321048703134e-002, 2.37307563333060e-001, 8.26947221054499e-001, 2.38499471777823e-001, 1.92977016250576e-001 },
 {-1.09826499790188e-001, 1.94002673278051e-002, -2.59441848139806e-002, 2.50382379145899e-002, 1.95585231763279e-001 },
 {1.07677437637682e-001, 4.77001496378409e-001, 1.09000238659731e+000, 4.08796562020852e-001, 7.96358185412932e-002 },
 {8.55767962415821e-001, 3.04954923669286e-001, -3.80273483429454e-001, 3.20891005989948e-001, -5.14854058573347e-001 },
 {5.38551585549258e-001, 4.58490313191454e-001, -3.19393451705478e-001, 4.67189815160821e-001, -2.61396516737650e-001 },
 {-2.07680634640420e-001, -5.62994870560190e-001, 3.42844048001399e-001, -5.22535893706202e-001, 2.32764620539708e-002 },
 {4.57567359848089e-001, 3.50414036736836e-001, -4.65299594653984e-001, 3.35637239522252e-001, -3.23420133680040e-001 },
 {5.70973217142794e-002, 3.17266035722581e-001, -3.59897410642051e-001, 2.37000080356460e-001, -4.67201957006365e-002 },
 {2.12520962737257e+000, 4.00210788275971e-001, -6.46860253696059e-001, 4.59097363577274e-001, -9.97172856267157e-001 },
 {-1.84314477434540e-001, 5.10935211253945e-001, -3.01142740252212e-001, 5.16673938350778e-001, 8.76843848494972e-001 },
 {1.04398547176453e-001, -5.85832086969141e-001, -2.56547896065951e-001, -6.60870690826520e-001, 1.46029873139771e+000 },
 {-1.59218776905845e-001, 1.36283758394579e-001, -1.44625402706233e-001, 2.16016122283042e-001, 1.83711844230451e-001 },
 {-1.33364572074713e-001, -2.61989094242208e-001, 9.46172692869087e-002, -2.55875825648679e-001, 1.43022119843916e-001 },
 {-1.00710691579330e-001, 1.13111942924787e+000, 1.03140033374470e+000, 1.08044668386447e+000, 1.55086383068075e-001 },
 {2.00248553615850e+000, 3.70152608436123e-001, -8.39573561647735e-001, 3.74974979958012e-001, -9.91812110007969e-001 },
 {1.44440753023736e-001, 1.39307151008267e-001, 3.47874810462517e-001, 7.76299245056260e-002, -1.58813291730271e-003 },
 {-6.34960355377434e-002, 2.01727353880628e-001, 6.35005412839801e-001, 7.74457368485861e-002, 9.15875497399304e-002 },
 {-4.89970032451199e-002, -1.36000869417223e+000, -1.12641570735040e+000, -1.41864386044438e+000, 1.53600152685510e+000 },
 {-1.63230977511457e-001, 5.26105013636530e-001, -1.05459744458960e+000, 5.78394613755617e-001, 3.28778088322939e-001 },
 {3.36383200245022e-001, 2.66511432727549e-002, 3.63388125216947e-001, 5.86519283932372e-002, -2.02744011781762e-001 },
 {2.34502077038896e-001, 8.11082874873038e-002, 5.14186471773124e-002, 1.69028162494792e-001, -1.94223112720464e-001 },
 {1.87476083930011e+000, 3.24408751826021e-001, -6.29056281005200e-001, 1.85351607356854e-001, -9.39462596379218e-001 },
 {1.54454026929773e-001, 5.90316508452238e-001, 7.48422360747549e-001, 6.22654957510816e-001, 8.05350799143400e-002 },
 {3.43893841217999e-001, 2.12369526208387e-001, 1.99006367457413e-001, 1.98626800777478e-001, -1.79486551958813e-001 },
 {9.65255035209708e-001, 2.28516582022655e-001, -2.66403532778563e-001, 2.28636394490233e-001, -5.45283942903162e-001 },
 {4.97033679798452e-001, 4.69971291224457e-001, -6.51568953843131e-001, 5.13767862703686e-001, -1.73063970269559e-001 },
 {1.75502169928701e-001, 4.48766833124100e-001, 5.10527232642554e-001, 5.34368439737069e-001, -1.19359062063828e-001 },
 {-6.43915972054156e-002, 4.98095774950975e-002, 1.38214730193788e-001, 6.41114115561716e-002, 5.56397821940781e-001 },
 {-2.37208392019349e-001, 5.17091414962305e-001, -5.30672208946289e-001, 4.56351623395429e-001, 5.71641841030352e-001 },
 {-1.19902661701920e-001, 1.29561914058835e-001, 7.80902429721165e-001, 4.04128308612755e-002, 3.66100706406736e-001 },
 {-7.79512645085670e-002, -9.44859369837160e-002, 3.88158662261953e-001, -1.79430022317195e-001, 4.24873345726291e-001 },
 {5.41831345064254e-001, 2.25547326819450e+000, 4.91238705872447e+000, 2.20726947950834e+000, -1.80615464032285e-001 },
 {-1.02863542353943e-001, -2.75166828614560e-001, 2.72202868246242e-001, -3.48777065943873e-001, 7.87863868249468e-001 },
 {3.61919502656272e-001, 2.08718820309279e-001, -8.91315022813639e-002, 2.63924578516893e-001, -1.98903570571506e-001 },
 {-8.49261946043157e-002, 6.19592356057918e-002, 3.05829663832035e-001, 1.55898901879839e-002, 5.45897832445954e-001 },
 {1.10025819869593e-001, -6.99179602321032e-001, -5.02862597456140e-001, -7.80661619013131e-001, 1.46008836587775e+000 },
 {-2.18555225258511e-001, 7.13426169537944e-001, -1.72007160076372e-001, 8.18587323628415e-001, 1.15635144872044e+000 },
 {2.03365591166067e-002, -6.58496380671699e-002, -3.06097702126969e-003, -1.27235112380767e-001, -7.46222962075645e-002 } 
};

double hidden_bias[40]={ -5.20767867953850e-001, 1.46482712014267e-001, -3.82478563334232e-002, -1.67180581487504e-001, -6.61376611164227e-002, 2.46338099517290e-001, 7.44925134873759e-002, -3.48568121984791e-001, -3.13939751852298e-001, -2.80034080696925e-001, 4.52628626061872e-001, 6.52121175422813e-002, -3.81839696905099e-001, -3.35907948167755e-001, -2.27159121714554e-001, -4.64865664787015e-001, 3.73294461969361e-001, 1.95558762355549e-001, -1.18631224138439e-001, -5.96517559675713e-001, -2.54158709130693e-001, 6.55032552741002e-002, 1.27910694905873e-001, 5.28956837471874e-001, -1.15668664374664e-003, 3.38252015690852e-001, 3.69289260414201e-001, 4.56566444026481e-002, -7.69771846749360e-002, 1.37799337964149e-001, -5.32180590349655e-002, -2.89180479757830e-001, -1.99937529757357e-001, -2.20666566404307e-001, -3.85697439966905e-001, 2.11049211872253e-001, -6.36167134356535e-002, -3.85494832834905e-001, 4.28851392846747e-001, -1.67449437345978e-001 };

double hidden_output_wts[1][40]=
{
 {-1.01241767546906e+000, -4.70323142346162e-001, 1.38463394960933e-001, 1.92820137110677e-001, 2.46615561017353e-001, -4.53904102048404e-001, -1.50120007697689e-001, 2.22076859561691e-002, -1.05389907246915e-001, 2.39989115840989e-001, -9.48907758687601e-001, 3.75053731310409e-001, 5.32889251089212e-001, 4.16806666138513e-001, 3.04335787576395e-002, 8.73562135166610e-001, -9.39212058573763e-001, -2.00587402910528e-001, 1.11044119170482e-001, 7.73400623045850e-001, 3.80095372891338e-003, -2.52497541981208e-001, -2.40910197127152e-001, -1.01303368557667e+000, 2.39223937857002e-001, -2.98376611293993e-001, -6.57283631239366e-001, -1.49557920970026e-001, 2.04756807647474e-001, 1.18525027077431e-001, 2.62105212931974e-001, 3.54509113137446e-001, 1.76599938064650e-001, 9.30879159150110e-001, 3.28621802676487e-001, -2.75811055116027e-001, 2.91741597831322e-001, 5.57315056249191e-001, 3.53396723322440e-001, -1.00146566702442e-001 }
};

double output_bias[1]={ 3.48149540699646e-001 };

double max_input[5]={ 6.43300000000000e-002, 5.64700000000000e-002, 7.94000000000000e-002, 1.69420000000000e-001, 3.30470000000000e+001 };

double min_input[5]={ 2.04000000000000e-003, 4.68000000000000e-003, 5.70000000000000e-003, 1.40300000000000e-002, 8.44100000000000e+000 };

double max_target[1]={ 1.00000000000000e+000 };

double min_target[1]={ 0.00000000000000e+000 };

double input[5];
double hidden[40];
double output[1];

void ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(max_input[i]-min_input[i]);
	input[i] = minimum - delta*min_input[i]+ delta*input[i];
 }
}

void UnscaleTargets(double* output, double minimum, double maximum, int size)
{
  double delta;
  long i;
  for(i=0; i<size; i++)
  {
    delta = (maximum-minimum)/(max_target[i]-min_target[i]);
    output[i] = (output[i] - minimum + delta*min_target[i])/delta;
   }
}

void ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = exp(V_OUT[row]);
      if(layer==1) V_OUT[row] = tanh(V_OUT[row]);
   }
}

void RunNeuralNet_Regression () 
{
  ComputeFeedForwardSignals((double*)input_hidden_weights,input,hidden,hidden_bias,5, 40,0);
  ComputeFeedForwardSignals((double*)hidden_output_wts,hidden,output,output_bias,40, 1,1);
}

int main()
{
  int i=0;
  int keyin=1;
  while(1)
  {
	printf("\nEnter values for Continuous inputs\n");
	printf("Cont. Input-0(Jitter:DDP): ");
	scanf("%lg",&input[0]);
	printf("Cont. Input-1(Shimmer:APQ3): ");
	scanf("%lg",&input[1]);
	printf("Cont. Input-2(Shimmer:APQ5): ");
	scanf("%lg",&input[2]);
	printf("Cont. Input-3(Shimmer:DDA): ");
	scanf("%lg",&input[3]);
	printf("Cont. Input-4(HNR): ");
	scanf("%lg",&input[4]);
    ScaleInputs(input,0,1,5);
	RunNeuralNet_Regression();
	UnscaleTargets(output,0,1,1);
	printf("\nPredicted Output of status = %.14e",output[0]);
	printf("\n\nPress any key to make another prediction or enter 0 to quit the program.\n");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

